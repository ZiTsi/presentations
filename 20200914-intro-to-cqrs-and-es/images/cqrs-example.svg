<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="490px" preserveAspectRatio="none" style="width:791px;height:490px;" version="1.1" viewBox="0 0 791 490" width="791px" zoomAndPan="magnify"><defs><filter height="300%" id="fw6zufhpcx1fu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[7579d5565d2521d5936cec86ed3dadee]
cluster service--><rect fill="#FFFFFF" filter="url(#fw6zufhpcx1fu)" height="466" style="stroke: #000000; stroke-width: 1.5;" width="767" x="7" y="7"/><path d="M137,7 L137,16.2969 L127,26.2969 L7,26.2969 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="120" x="10" y="20.9951">Logical service</text><!--MD5=[433b840f2dcb388b66888f917e6f6a3c]
entity writeuser--><path d="M59.1198,51.5689 C61.2827,45.8668 66.2985,44.6066 70.2098,49.7872 C72.6266,44.8214 76.745,43.7927 80.6898,48.0514 C84.8008,43.2177 89.7456,45.508 91.5681,50.5677 C94.8861,44.4177 98.8565,45.6449 102.6834,50.0309 C111.8001,53.0866 114.2672,59.1563 106.8948,66.4431 C113.2857,72.5866 112.437,77.3091 104.4377,81.0284 C103.6703,88.5655 98.893,90.857 92.6011,86.5489 C90.4778,93.1127 86.3489,95.3135 80.1609,91.3539 C74.2792,95.4645 71.0428,93.4425 69.5135,86.9736 C63.7979,89.3236 59.3836,88.4866 59.2991,81.079 C50.8057,78.1055 49.1598,70.6696 56.9352,65.2643 C51.2217,59.8672 52.8384,55.0526 59.1198,51.5689 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="64.5" y="69.9951">User</text><!--MD5=[84dc2bd9defcde1342bbd561f2df8fc4]
entity readuser--><path d="M652.1198,174.5689 C654.2827,168.8668 659.2985,167.6066 663.2098,172.7872 C665.6266,167.8214 669.745,166.7927 673.6898,171.0514 C677.8008,166.2177 682.7456,168.508 684.5681,173.5677 C687.8861,167.4177 691.8565,168.6449 695.6834,173.0309 C704.8001,176.0866 707.2672,182.1563 699.8948,189.4431 C706.2857,195.5866 705.437,200.3091 697.4377,204.0284 C696.6703,211.5655 691.893,213.857 685.6011,209.5489 C683.4778,216.1127 679.3489,218.3135 673.1609,214.3539 C667.2792,218.4645 664.0428,216.4425 662.5135,209.9736 C656.7979,212.3236 652.3836,211.4866 652.2991,204.079 C643.8057,201.1055 642.1598,193.6696 649.9352,188.2643 C644.2217,182.8672 645.8384,178.0526 652.1198,174.5689 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="657.5" y="192.9951">User</text><!--MD5=[8ba8a5b5023919418da82b2ee0feb977]
entity bus1--><path d="M171,175 L271,175 C276,175 276,188.1484 276,188.1484 C276,188.1484 276,201.2969 271,201.2969 L171,201.2969 C166,201.2969 166,188.1484 166,188.1484 C166,188.1484 166,175 171,175 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #A80036; stroke-width: 1.5;"/><path d="M271,175 C266,175 266,188.1484 266,188.1484 C266,201.2969 271,201.2969 271,201.2969 " fill="none" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="171" y="192.9951">Message bus</text><!--MD5=[e2036d619e269b413bcce54baaf8a134]
entity bus2--><path d="M467,175 L567,175 C572,175 572,188.1484 572,188.1484 C572,188.1484 572,201.2969 567,201.2969 L467,201.2969 C462,201.2969 462,188.1484 462,188.1484 C462,188.1484 462,175 467,175 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #A80036; stroke-width: 1.5;"/><path d="M567,175 C562,175 562,188.1484 562,188.1484 C562,201.2969 567,201.2969 567,201.2969 " fill="none" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="467" y="192.9951">Message bus</text><!--MD5=[e2307af040e3f87d22824e7603ca28ec]
entity api--><polygon fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" points="268.5,52,278.5,42,375.5,42,375.5,78.2969,365.5,88.2969,268.5,88.2969,268.5,52" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="365.5" x2="375.5" y1="52" y2="42"/><line style="stroke: #000000; stroke-width: 1.5;" x1="268.5" x2="365.5" y1="52" y2="52"/><line style="stroke: #000000; stroke-width: 1.5;" x1="365.5" x2="365.5" y1="52" y2="88.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="283.5" y="74.9951">Write API</text><!--MD5=[37c33c71ce9550fe283f62c54b59719b]
entity application--><polygon fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" points="263,298,273,288,425,288,425,324.2969,415,334.2969,263,334.2969,263,298" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="415" x2="425" y1="298" y2="288"/><line style="stroke: #000000; stroke-width: 1.5;" x1="263" x2="415" y1="298" y2="298"/><line style="stroke: #000000; stroke-width: 1.5;" x1="415" x2="415" y1="298" y2="334.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="278" y="320.9951">Application layer</text><!--MD5=[8890788e37b11dd3053f547e2b5ce265]
entity domain--><polygon fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" points="266.5,421,276.5,411,361.5,411,361.5,447.2969,351.5,457.2969,266.5,457.2969,266.5,421" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="351.5" x2="361.5" y1="421" y2="411"/><line style="stroke: #000000; stroke-width: 1.5;" x1="266.5" x2="351.5" y1="421" y2="421"/><line style="stroke: #000000; stroke-width: 1.5;" x1="351.5" x2="351.5" y1="421" y2="457.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="281.5" y="443.9951">Domain</text><!--MD5=[ffd8157a53f042ce49977e8e11d18a34]
entity denormalizer--><polygon fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" points="460.5,298,470.5,288,613.5,288,613.5,324.2969,603.5,334.2969,460.5,334.2969,460.5,298" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="603.5" x2="613.5" y1="298" y2="288"/><line style="stroke: #000000; stroke-width: 1.5;" x1="460.5" x2="603.5" y1="298" y2="298"/><line style="stroke: #000000; stroke-width: 1.5;" x1="603.5" x2="603.5" y1="298" y2="334.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="113" x="475.5" y="320.9951">Query Projector</text><!--MD5=[a096c1983bcf686c95ea726f28f7a0ed]
entity query--><polygon fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" points="648.5,298,658.5,288,757.5,288,757.5,324.2969,747.5,334.2969,648.5,334.2969,648.5,298" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="747.5" x2="757.5" y1="298" y2="288"/><line style="stroke: #000000; stroke-width: 1.5;" x1="648.5" x2="747.5" y1="298" y2="298"/><line style="stroke: #000000; stroke-width: 1.5;" x1="747.5" x2="747.5" y1="298" y2="334.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="663.5" y="320.9951">Query API</text><!--MD5=[ded6a69210fbbc7961dee7b773232267]
entity es--><path d="M23,298.5 C23,288.5 76,288.5 76,288.5 C76,288.5 129,288.5 129,298.5 L129,323.7969 C129,333.7969 76,333.7969 76,333.7969 C76,333.7969 23,333.7969 23,323.7969 L23,298.5 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M23,298.5 C23,308.5 76,308.5 76,308.5 C76,308.5 129,308.5 129,298.5 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="33" y="325.4951">Event Store</text><!--MD5=[bc2776aa256374151038800587e9a1ee]
entity vms--><path d="M567,421.5 C567,411.5 620,411.5 620,411.5 C620,411.5 673,411.5 673,421.5 L673,446.7969 C673,456.7969 620,456.7969 620,456.7969 C620,456.7969 567,456.7969 567,446.7969 L567,421.5 " fill="#FEFECE" filter="url(#fw6zufhpcx1fu)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M567,421.5 C567,431.5 620,431.5 620,431.5 C620,431.5 673,431.5 673,421.5 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="577" y="448.4951">Query Store</text><!--MD5=[a8fa5f3eb82f8c2910daf8692e60b541]
link es to application--><path codeLine="19" d="M129.113,326.277 C137.861,328.239 146.884,329.933 155.5,331 C191.227,335.425 200.652,334.306 236.5,331 C243.488,330.355 250.7,329.48 257.925,328.454 " fill="none" id="es-to-application" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="262.926,327.72,253.4407,325.0686,257.9789,328.4457,254.6019,332.9839,262.926,327.72" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="156.5" y="327.0669">Load events</text><!--MD5=[f2e8f4ac193cf99b74fff9a0c2faa3bb]
reverse link es to application--><path codeLine="23" d="M134.725,311 C172.295,311 221.552,311 262.84,311 " fill="none" id="es-backto-application" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="129.269,311,138.269,315,134.269,311,138.269,307,129.269,311" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="147.5" y="304.0669">Append events</text><!--MD5=[119855ab48fde576c87c89b4f41679e2]
link application to domain--><path codeLine="20" d="M342.077,334.003 C340.571,347.679 338.039,365.541 334,381 C331.834,389.2924 328.771,398.0742 325.692,406.0132 " fill="none" id="application-to-domain" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="323.78,410.8355,330.8154,403.9433,325.6228,406.1875,323.3786,400.9948,323.78,410.8355" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="339" y="377.0669">Handle command</text><!--MD5=[5c4cdf8f238499ae80346a064078cb56]
reverse link application to domain--><path codeLine="21" d="M275.808,336.76 C264.711,343.843 254.679,352.786 248,364 C237.481,381.66 252.638,398.4008 271.064,410.9692 " fill="none" id="application-backto-domain" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="280.278,334.036,270.5109,335.3026,276.008,336.6374,274.6732,342.1345,280.278,334.036" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="249" y="377.0669">New events</text><!--MD5=[d0c4b59061b8a98d092dd58756ca25c9]
reverse link bus2 to application--><path codeLine="24" d="M486.741,203.375 C467.554,213.013 442.564,226.55 422,241 C402.03,255.033 381.431,273.454 366.42,287.732 " fill="none" id="bus2-backto-application" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="491.488,201.01,481.6486,201.4409,487.0122,203.2386,485.2144,208.6022,491.488,201.01" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="423" y="254.0669">Publish events</text><!--MD5=[e8f6aeed3661ab20602055f24d2f4cb4]
link bus2 to denormalizer--><path codeLine="26" d="M518.991,201.044 C522.122,219.986 528.275,257.215 532.511,282.841 " fill="none" id="bus2-to-denormalizer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="533.331,287.802,535.8091,278.27,532.5153,282.869,527.9163,279.5752,533.331,287.802" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="529" y="254.0669">Handle events</text><!--MD5=[3bc5bcd2aade5d18c1e67064ef10f7aa]
link denormalizer to vms--><path codeLine="28" d="M542.435,334.086 C546.602,348.29 553.302,366.696 563,381 C569.709,390.8953 578.668,400.2112 587.493,408.1491 " fill="none" id="denormalizer-to-vms" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="591.26,411.4643,587.1459,402.5159,587.5064,408.1613,581.861,408.5217,591.26,411.4643" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="377.0669">project event</text><!--MD5=[79dcb5b09f4e0b29f7d7f27184e24672]
reverse link query to vms--><path codeLine="30" d="M684.863,338.441 C669.873,360.294 648.851,390.9395 634.848,411.3545 " fill="none" id="query-backto-vms" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="687.777,334.193,679.3883,339.3534,684.9493,338.3166,685.9861,343.8777,687.777,334.193" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="667" y="377.0669">Query</text><!--MD5=[07ddd7e1dd1dd1dda8263d524de0d04b]
link writeuser to api--><path codeLine="32" d="M110.649,65 C148.813,65 214.838,65 262.958,65 " fill="none" id="writeuser-to-api" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="268.144,65,259.144,61,263.144,65,259.144,69,268.144,65" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="129" y="58.0669">Change something</text><!--MD5=[92ed7ba84cbc55f4b418ba9da83cba0b]
link api to application--><path codeLine="33" d="M331.915,88.064 C335.503,97.144 339.129,107.887 341,118 C351.696,175.802 349.081,245.067 346.417,282.581 " fill="none" id="api-to-application" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="346.025,287.881,350.6776,279.2004,346.3936,282.8946,342.6994,278.6106,346.025,287.881" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="359.5" y="185.0669">Change</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="350" y="200.1997">something</text><!--MD5=[ce73c600265fa948c0379d30e2b9ee01]
link api to bus1--><path codeLine="35" d="M297.002,88.033 C287.484,96.933 276.815,107.558 268,118 C253.888,134.717 240.078,155.708 231.12,170.121 " fill="none" id="api-to-bus1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="228.275,174.741,236.4014,169.1767,230.8977,170.4841,229.5904,164.9804,228.275,174.741" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="269" y="131.0669">Command</text><!--MD5=[275ab493c6b7b9674c8101b62679a437]
link bus1 to application--><path codeLine="36" d="M233.243,201.044 C252.819,220.302 291.61,258.461 317.684,284.112 " fill="none" id="bus1-to-application" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="321.435,287.802,317.8234,278.6392,317.8703,284.2959,312.2136,284.3427,321.435,287.802" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e3b16c886fe985ee954529e6c5b35545]
link readuser to query--><path codeLine="38" d="M678.502,211.193 C683.514,231.405 690.927,261.307 696.286,282.919 " fill="none" id="readuser-to-query" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="697.532,287.947,699.2466,278.2485,696.3277,283.0942,691.4821,280.1754,697.532,287.947" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="690" y="254.0669">Get resource</text><!--MD5=[0ab0e16bbad47e3c369b8372ab7bb30f]
link application to denormalizer--><!--MD5=[57b6d156162fe55161bbe79b2d13bdfc]
@startuml
allow_mixing

frame "Logical service" as service {

cloud "User" as writeuser
cloud "User" as readuser

queue "Message bus" as bus1
queue "Message bus" as bus2
node "Write API" as api
node "Application layer" as application
node "Domain" as domain
node "Query Projector" as denormalizer
node "Query API" as query

database "Event Store" as es
database "Query Store" as vms

es -right-> application : Load events
application - -> domain : Handle command
application <- - domain : New events

application -left-> es : Append events
application -up-> bus2 : Publish events

bus2 -down-> denormalizer : Handle events

denormalizer -down-> vms : project event

query <- - vms : Query

writeuser -right-> api : Change something
api .down.> application : Change\nsomething

api ..> bus1 : Command
bus1 ..> application

readuser -down-> query : Get resource

application -[hidden]right-> denormalizer

}
@enduml

PlantUML version 1.2020.17beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>